# Terminal settings
set-option -g default-shell /opt/homebrew/bin/nu
set-option -g default-terminal "tmux-256color"
set-option -sa terminal-overrides ",*:Tc"
set -g xterm-keys on
set -s extended-keys on
set -as terminal-features 'xterm-256color:extkeys'
set -as terminal-features '*:extkeys'

# Plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'artemave/tmux_super_fingers'

# Unbind C-/ to allow it to pass through to nvim
unbind C-/

# Toggle pane zoom with C-\
bind-key -n 'C-\' if-shell '[ "$(tmux list-panes | wc -l | bc)" = 1 ]' 'split-window' 'resize-pane -Z'

# Automatically rename windows based on current directory
set-option -g automatic-rename on
set-option -g automatic-rename-format '#{b:pane_current_path}'
set-option -g status-interval 5

# Always show directory name, not the running process
set-option -g allow-rename off

set -ga update-environment EDITOR

# vim-tmux-navigator
is_vim="ps -o state= -o comm= -t '#{pane_tty}' | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
bind-key -n 'C-h' if-shell "$is_vim" 'send-keys C-h' 'select-pane -L'
bind-key -n 'C-j' if-shell "$is_vim" 'send-keys C-j' 'select-pane -D'
bind-key -n 'C-k' if-shell "$is_vim" 'send-keys C-k' 'select-pane -U'
bind-key -n 'C-l' if-shell "$is_vim" 'send-keys C-l' 'select-pane -R'

bind-key -T copy-mode-vi 'C-h' select-pane -L
bind-key -T copy-mode-vi 'C-j' select-pane -D
bind-key -T copy-mode-vi 'C-k' select-pane -U
bind-key -T copy-mode-vi 'C-l' select-pane -R

# Vim mode for copy
setw -g mode-keys vi
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel
bind-key -T copy-mode-vi r send-keys -X rectangle-toggle

# ===== MODERN THEME (Catppuccin Frappe) =====
# Colors from nvim colorscheme.lua frappe palette:
# blue=#92a2d5, lavender=#b7aed5, green=#90b99f, teal=#85b5ba
# mauve=#aca1cf, pink=#ea83a5, red=#ea83a5, peach=#f5a191
# yellow=#e6b99d, text=#c9c7cd, subtext1=#b4b1ba, overlay0=#444448
# surface2=#3b3b3e, surface1=#313134, surface0=#2a2a2c, base=#161617

# Status bar position
set-option -g status-position top

# General status bar styling
set -g status-style "bg=default"
set -g status-justify "left"

# Left side - session name with background
set -g status-left-length 50
set -g status-left "#[fg=#161617,bg=#92a2d5,bold]  #S #[bg=default] "

# Right side - empty
set -g status-right ""

# Window status styling - dot separated, transparent background
set -g window-status-format "#[fg=#6c6874,bg=default]#W"
set -g window-status-current-format "#[fg=#92a2d5,bg=default,bold]#W"
set -g window-status-separator "#[fg=#444448,bg=default] Â· "

# Pane borders
set -g pane-border-style "fg=#313134"
set -g pane-active-border-style "fg=#92a2d5"

# Message styling
set -g message-style "fg=#c9c7cd,bg=#313134"
set -g message-command-style "fg=#c9c7cd,bg=#313134"

# Mode styling (copy mode, etc.)
set -g mode-style "fg=#161617,bg=#92a2d5"

# Clock mode
set -g clock-mode-colour "#92a2d5"

# Initialize TMUX plugin manager
run '~/.tmux/plugins/tpm/tpm'

